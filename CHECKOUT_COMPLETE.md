# ‚úÖ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–æ

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. CheckoutController
**–§–∞–π–ª:** `app/Http/Controllers/CheckoutController.php`

–ú–µ—Ç–æ–¥—ã:
- `index()` - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
- `store()` - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –≤ –ë–î
- `success()` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞

### 2. –†–æ—É—Ç–∏–Ω–≥
```php
GET  /checkout                           - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
POST /checkout                           - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
GET  /checkout/success/{orderNumber}     - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—Ö–∞
```

### 3. Views
- `checkout/index.blade.php` - –§–æ—Ä–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
- `checkout/success.blade.php` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—Ö–∞

### 4. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

#### –§–æ—Ä–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
- ‚úÖ Email (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –ò–º—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∏—Ç–æ–≥–æ–≤–æ–π —Å—É–º–º—ã

#### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –†–∞—Å—á–µ—Ç —Å—É–º–º—ã –∑–∞–∫–∞–∑–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ Order –≤ –ë–î
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞ (ORD-XXXXXXXX)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–∞ (OrderItem)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (OrderDownload)
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ï—Å–ª–∏ email –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω - —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- ‚úÖ –ü–∞—Ä–æ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (16 —Å–∏–º–≤–æ–ª–æ–≤)
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –∑–∞–∫–∞–∑–æ–º

#### –î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º
- ‚úÖ –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ —Å file_path —Å–æ–∑–¥–∞–µ—Ç—Å—è OrderDownload
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- ‚úÖ –õ–∏–º–∏—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏–π: 5 —Ä–∞–∑
- ‚úÖ –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: 1 –≥–æ–¥

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### Order (–∑–∞–∫–∞–∑)
- `number` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä (ORD-XXXXXXXX)
- `email` - Email –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `name`, `phone` - –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `total` - –°—É–º–º–∞ –∑–∞–∫–∞–∑–∞
- `status` - –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ (pending, processing, completed, ...)
- `payment_status` - –°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã (pending, paid, failed, ...)

### OrderItem (–ø–æ–∑–∏—Ü–∏—è –∑–∞–∫–∞–∑–∞)
- `product_id` - ID —Ç–æ–≤–∞—Ä–∞
- `product_name`, `product_sku` - –ö–æ–ø–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞
- `quantity` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
- `price`, `subtotal` - –¶–µ–Ω—ã

### OrderDownload (–¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º)
- `download_token` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- `download_limit` - –õ–∏–º–∏—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏–π (5)
- `expires_at` - –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (1 –≥–æ–¥)

---

## ‚è≠Ô∏è –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –†–æ–±–æ–∫–∞—Å—Å—ã**
   - –°–æ–∑–¥–∞—Ç—å RobokassaService
   - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ–ø–ª–∞—Ç—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
   - Webhook –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã

2. **–ó–∞—â–∏—Ç–∞ —Ñ–∞–π–ª–æ–≤**
   - DownloadController –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

3. **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç**
   - –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤
   - –î–æ—Å—Ç—É–ø –∫ –∫—É–ø–ª–µ–Ω–Ω—ã–º —Ñ–∞–π–ª–∞–º
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ—Ü–µ—Å—Å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞:
1. –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É
2. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ `/checkout`
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É (email –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)
4. –ù–∞–∂–∞—Ç—å "–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ"
5. –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω, –∫–æ—Ä–∑–∏–Ω–∞ –æ—á–∏—â–µ–Ω–∞
6. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—Ö–∞ —Å –Ω–æ–º–µ—Ä–æ–º –∑–∞–∫–∞–∑–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î:
```sql
SELECT * FROM orders ORDER BY id DESC LIMIT 1;
SELECT * FROM order_items WHERE order_id = <id>;
SELECT * FROM order_downloads WHERE order_id = <id>;
```

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –†–æ–±–æ–∫–∞—Å—Å—ã
