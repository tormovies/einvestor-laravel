# ðŸš€ Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð±ÐµÑÐºÐ¾Ð½ÐµÑ‡Ð½Ñ‹Ñ… Ñ†Ð¸ÐºÐ»Ð¾Ð² Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ð²

**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°:** Ð ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ñ‹ `/refund_returns` -> `/` Ð¸ `/shop` -> `/` Ð²Ñ‹Ð·Ñ‹Ð²Ð°Ð»Ð¸ `ERR_TOO_MANY_REDIRECTS`

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:** Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð³Ð»Ð°Ð²Ð½Ð°Ñ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ð½Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐ»Ð°ÑÑŒ Ð½Ð° Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ñ‹

## ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð´Ð»Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ (Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð¿Ð¾ÑˆÐ°Ð³Ð¾Ð²Ð¾):

### 1. ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ
```bash
ssh adminfeg@narnia
```

### 2. ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
```bash
cd ~/einvestor.ru/laravel
```

### 3. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
```bash
git pull origin main
```

### 4. ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÐºÐµÑˆÐ°
```bash
php8.3 artisan optimize:clear
```

### 5. ÐšÐµÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
```bash
php8.3 artisan config:cache
```

### 6. ÐšÐµÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð²
```bash
php8.3 artisan route:cache
```

### 7. ÐšÐµÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ð¹
```bash
php8.3 artisan view:cache
```

## âš ï¸ Ð’ÐÐ–ÐÐž: ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð½Ñ‹Ð¹ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚

ÐŸÐ¾ÑÐ»Ðµ Ð´ÐµÐ¿Ð»Ð¾Ñ Ð½ÑƒÐ¶Ð½Ð¾ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚ Ñ Ð¿ÑƒÑÑ‚Ñ‹Ð¼ `old_url`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ñ†Ð¸ÐºÐ»:

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 1: Ð§ÐµÑ€ÐµÐ· tinker (Ð¸Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾)
```bash
php8.3 artisan tinker
```

Ð—Ð°Ñ‚ÐµÐ¼ Ð² tinker Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ:
```php
\App\Models\Redirect::where('old_url', '')->update(['is_active' => false]);
exit
```

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 2: ÐžÐ´Ð½Ð¾Ð¹ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹
```bash
php8.3 artisan tinker --execute="\App\Models\Redirect::where('old_url', '')->update(['is_active' => false]); echo 'Ð ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½';"
```

## ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ Ð´ÐµÐ¿Ð»Ð¾Ñ:

1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚ `/refund_returns`:
   ```
   https://einvestor.ru/refund_returns
   ```
   Ð”Ð¾Ð»Ð¶ÐµÐ½ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ð¸Ñ‚ÑŒ Ð½Ð° Ð³Ð»Ð°Ð²Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ð±ÐµÐ· Ñ†Ð¸ÐºÐ»Ð¾Ð²

2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚ `/shop`:
   ```
   https://einvestor.ru/shop
   ```
   Ð”Ð¾Ð»Ð¶ÐµÐ½ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ð¸Ñ‚ÑŒ Ð½Ð° Ð³Ð»Ð°Ð²Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ð±ÐµÐ· Ñ†Ð¸ÐºÐ»Ð¾Ð²

3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð³Ð»Ð°Ð²Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ:
   ```
   https://einvestor.ru/
   ```
   Ð”Ð¾Ð»Ð¶Ð½Ð° Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°Ñ‚ÑŒÑÑ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾, Ð±ÐµÐ· Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ð²

## Ð§Ñ‚Ð¾ Ð±Ñ‹Ð»Ð¾ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾:

1. âœ… Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð² Ð½Ð°Ñ‡Ð°Ð»Ðµ middleware - Ð³Ð»Ð°Ð²Ð½Ð°Ñ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° (Ð¿ÑƒÑÑ‚Ð¾Ð¹ Ð¿ÑƒÑ‚ÑŒ) ÐÐ• Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ÑÑ Ð½Ð° Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ñ‹
2. âœ… Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð° Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ñ†Ð¸ÐºÐ»Ð¾Ð² Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ð²
3. âœ… ÐŸÑ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ñ‹ Ð±ÐµÑÐºÐ¾Ð½ÐµÑ‡Ð½Ñ‹Ðµ Ñ†Ð¸ÐºÐ»Ñ‹ Ð´Ð»Ñ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ð² Ð½Ð° Ð³Ð»Ð°Ð²Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ

## Ð•ÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ð¾ÑÑ‚Ð°Ð»Ð°ÑÑŒ:

1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸:
   ```bash
   tail -f storage/logs/laravel.log
   ```

2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ñ‹:
   ```bash
   php8.3 artisan redirects:test
   ```

3. Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚ Ñ Ð¿ÑƒÑÑ‚Ñ‹Ð¼ `old_url` Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½:
   ```bash
   php8.3 artisan tinker --execute="echo json_encode(\App\Models\Redirect::where('old_url', '')->get(['id', 'old_url', 'new_url', 'is_active'])->toArray(), JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE);"
   ```
